<div class="row">
    <div class="col-lg-12">
        <ol class="breadcrumb">
            <li><a href="">Главная</a></li>
            <li class="active"><span>История</span></li>
        </ol>
        <br>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <div class="main-box clearfix">
            <header class="main-box-header clearfix">

            </header>

            <div class="main-box-body clearfix">
                <div class="table-responsive" id="top">
                    <table class="table">
                        <thead>
                        <tr>
                            <th class="text-center"><a href="" ng-click="changeOrder()" class="{{order}}"><span>Дата публикации</span></a></th>
                            <th class="text-center"><span>Содержимое поста</span></th>
                            <th class="text-center"><span>Превью</span></th>
                            <th class="text-center"><span>Аккаунты</span></th>

                        </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="element in history">
                                <td class="text-center">
                                    <time>
                                        {{getTime(element.updated_at)}}
                                    </time>
                                </td>
                                <td class="text-center">
                                    <div class="post-content" style="max-width: 400px; text-align:left; margin: 0 auto;">{{element.data.message}}</div>
                                </td>
                                <td class="text-center">
                                    <img style="max-width: 75px; max-height: 75px;" src="http://tlgbot.mlg.ddemo.ru/storage/download/{{parJson(element.data.photo)[0].file_path}}" alt="" ng-show="element.data.photo">
                                </td>
                                <td>
                                    <table>
                                        <tbody>
                                        <tr ng-repeat="elem in element.elements">
                                            <td style="text-align:left;" ng-show="elem.data.job_status=='POSTED' || elem.data.job_status=='FAIL'">
                                                <a ng-show="elem.type=='vkontakte'" target="_blank" href="https://vk.com/club{{elem.account.data.groups.id}}?w=wall-{{elem.account.data.groups.id}}_{{parJson(elem.data.job_result).post_id}}%2Fall">{{elem.account.data.groups.name}}</a>
                                                <a ng-show="elem.type=='facebook'" target="_blank" href="https://www.facebook.com/groups/{{parJson(elem.data.job_result).id.split('_')[0]}}/permalink/{{parJson(elem.data.job_result).id.split('_')[1]}}/">{{elem.account.data.groups.name}}</a>
                                                <p ng-show="elem.type=='instagram' && element.data.photo" target="_blank">{{elem.data.wall_id}}</p>
                                            </td>
                                            <td style="text-align:left;" ng-show="elem.data.job_status=='QUEUED'">
                                                <p ng-show="elem.type=='vkontakte'">{{elem.account.data.groups.name}}</p>
                                                <p ng-show="elem.type=='facebook'">{{elem.account.data.groups.name}}</p>
                                                <p ng-show="elem.type=='instagram' && element.data.photo" target="_blank">{{elem.data.wall_id}}</p>
                                            </td>
                                            <td>
                                                <span class="label label-success" ng-show="elem.type!='instagram' && elem.data.job_status=='POSTED' || elem.type=='instagram' && element.data.photo && elem.data.job_status=='POSTED'">Опубликовано</span>
                                                <span class="label label-danger" ng-show="elem.type!='instagram' && elem.data.job_status=='FAIL' || elem.type=='instagram' && element.data.photo && elem.data.job_status=='FAIL'">Ошибка</span>
                                                <span class="label label-warning" ng-show="elem.type!='instagram' && elem.data.job_status=='QUEUED' || elem.type=='instagram' && element.data.photo && elem.data.job_status=='QUEUED'">В ожидании публикации</span>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div ng-include='"views/common/historyPagination.html"'></div>
            </div>
        </div>
    </div>
</div>